version: '3.4'

volumes:
  web_data:
    name: ${CONTAINER_NAME}
  db_data:
    name: ${CONTAINER_NAME}_db

services:

  odoo:
    container_name: ${CONTAINER_NAME}
    image: odoo:17
    ports:
      - 8069:8069
    volumes:
      - web_data:/var/lib/odoo/
      - "./modules:/mnt/extra-addons:rw"
      - "./odoo.conf:/etc/odoo/odoo.conf:rw"

    environment:
    - USER=${POSTGRES_USER}
    - PASSWORD=${POSTGRES_PASSWORD}

  db:
    container_name: ${CONTAINER_NAME}_db
    image: postgres:16.4
    restart: always
    volumes:
      - db_data:/var/lib/postgresql/data
    environment:
    - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
    - POSTGRES_USER=${POSTGRES_USER}
    - POSTGRES_DB=postgres
  pgweb:
    container_name: pgweb  # optional
    restart: always  # optional
    image: sosedoff/pgweb
    ports:
      - "8081:8081"
    environment:
      - PGWEB_DATABASE_URL=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${CONTAINER_NAME}_db:5432/postgres

networks:
  default:
    external:
      name: $DEFAULT_NETWORK